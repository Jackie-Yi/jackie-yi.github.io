<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title></title>
    <url>/2021/10/28/hello-world/</url>
    <content><![CDATA[<p><strong>gggenes</strong> 是一款基于ggplot2开发的R包，可以很方便的画出下图所示的基因结构图。</p>
<img src="/img/clipboard.png" style="zoom:75%;" />

<p><strong>1.</strong> <strong>安装R包</strong></p>
<p>直接从CRAN官方源来安装：</p>
<p> <code>install.packages(&quot;gggenes&quot;)</code>              </p>
<p>或者从github下载安装：</p>
<p> <code>devtools</code>::install_github(“wilkox/gggenes”)`              </p>
<p><strong>2. 准备输入数据</strong></p>
<p>官方给的例子如下：</p>
<p><code>&gt; head(example_genes)   molecule gene  start    end  strand direction 1  Genome5 genA 405113 407035 forward         1 2  Genome5 genB 407035 407916 forward         1 3  Genome5 genC 407927 408394 forward         1 4  Genome5 genD 408387 408737 reverse        -1 5  Genome5 genE 408751 409830 forward         1 6  Genome5 genF 409836 410315 forward         1</code>              </p>
<p>输入数据应该包含6列，分别代表：</p>
<p>物种名  基因名  起始位置  结束位置  基因方向  基因方向</p>
<p>如果不需要考虑画出基因方向的话，只需要前4列数据就行：<strong>物种名，基因名，起始位置，结束位置</strong></p>
<p>如果加上基因方向，就需要加上 strand 这一列，正负链分用“forward”和“reverse”表示。示例数据中的 direction 这一列是多余的，并不会被用到。</p>
<p><strong>2. 作图</strong></p>
<p><code>library(ggplot2) library(gggenes) ggplot(example_genes, aes(xmin = start, xmax = end,    y = molecule, fill = gene)) +   geom_gene_arrow() +   facet_wrap(~ molecule, scales = &quot;free&quot;, ncol = 1) +   scale_fill_brewer(palette = &quot;Set3&quot;) +   theme_genes()</code>              </p>
<img src="/img/图片1.jpg" style="zoom:67%;" />

<p>gggenes也可以如上图所示展现基因结构域特征或者比对信息，可以使用geom_subgene_arrow() 函数来实现，需要额外用到另一份数据example_subgenes，代码如下：</p>
<blockquote>
<p><code>&gt; head(example_subgenes)   molecule gene  start    end  strand subgene   from     to 1  Genome5 genA 405113 407035 forward  genA-1 405774 406538 2  Genome5 genB 407035 407916 forward  genB-1 4![图片1](D:\jackie blog\jackie-yi\source\img\图片1.jpg)7458 407897 3  Genome5 genC 407927 408394 forward  genC-1 407942 408158 4  Genome5 genC 407927 408394 forward  genC-2 408186 408209 5  Genome5 genC 407927 408394 forward  genC-3 408233 408257</code></p>
</blockquote>
<p>  <code>ggplot(example_genes, aes(xmin = start, xmax = end, y = molecule)) +   facet_wrap(~ molecule, scales = &quot;free&quot;, ncol = 1) +   geom_gene_arrow(fill = &quot;white&quot;) +   geom_subgene_arrow(data = example_subgenes,     aes(xmin = start, xmax = end, y = molecule, fill = gene,         xsubmin = from, xsubmax = to), color=&quot;black&quot;, alpha=.7) +   theme_genes()</code></p>
]]></content>
  </entry>
  <entry>
    <title>first-blog</title>
    <url>/2021/10/28/first-blog/</url>
    <content><![CDATA[]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
</search>
